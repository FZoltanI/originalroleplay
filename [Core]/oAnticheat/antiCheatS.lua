local core = exports.oCore
local color = core:getServerColor()
local red = "#ff3929"

local glitches = {"quickreload", "fastmove", "fastfire", "crouchbug", "highcloserangedamage", "hitanim", "fastsprint", "baddrivebyhitbox", "quickstand", "kickoutofvehicle_onmodelreplace"}

addEventHandler("onResourceStart", resourceRoot, function()    
    for _, glitch in ipairs(glitches) do
        setGlitchEnabled(glitch, false)
    end 
end)

function sendMessageToAdmins(msg)
    for k, v in ipairs(getElementsByType("player")) do 
        local alevel = getElementData(v, "user:admin") or 0
        if alevel >= 2 then 
            if not getElementData(v, "showAlogs") then 
                outputChatBox(msg, v, 255, 255, 255, true)
            end
        end
    end
end
addEvent("sendMessageToAdmins", true)
addEventHandler("sendMessageToAdmins", resourceRoot, sendMessageToAdmins)

-- Anticheat log
function createFileIfNotExists(filename)
	local file = fileOpen(filename)
	if not (file) then
		file = fileCreate(filename)
	end
	return file
end

function logAnticheat(msg)
	local r = getRealTime()
	local today = ("%04d_%02d_%02d"):format(r.year+1900, r.month + 1, r.monthday)
	local file = createFileIfNotExists("logs/"..today..".log")
	local size = fileGetSize(file)
	msg = "[" .. ("%04d-%02d-%02d %02d:%02d:%02d"):format(r.year+1900, r.month + 1, r.monthday, r.hour,r.minute, r.second) .. "] " .. msg .. ""
	fileSetPos(file, size)
	fileWrite(file, msg.."\r\n")
	fileFlush(file)
	fileClose(file)
	
	outputDebugString(msg)
end
addEvent("logAnticheat", true)
addEventHandler("logAnticheat", root, logAnticheat)

-- IP check 

local legitCountries = {
    ["HU"] = "Magyarország / Hungary",
    ["DE"] = "Németország / Germany",
	["AU"] = "Ausztria / Austria",
	["AT"] = "Ausztria / Austria",
    ["RO"] = "Románia / Romania",
    ["CZ"] = "Csehszlovákia / Czechoslovakia",
    ["SK"] = "Szlovákia / Slovakia",
    ["GB"] = "Anglia / England",
    ["HR"] = "Horvátország / Croatia",
    ["RS"] = "Szerbia / Serbia",
    ["NL"] = "Hollandia / Netherlands",
    ["UA"] = "Ukrajna / Ukraine",
    ["DK"] = "Dánia / Denmark",
    ["FR"] = "Franciaország / Franche"
}

local ipList = {
	{"2.112.0.0", "2.119.255.255"},
	{"2.113.104.0", "2.113.104.255"},
	{"2.136.0.0", "2.143.255.255"},
	{"2.143.128.0", "2.143.255.255"},
	{"5.2.80.0", "5.2.83.255"},
	{"5.9.0.0", "5.9.255.255"},
	{"5.9.20.64", "5.9.20.95"},
	{"5.9.39.0", "5.9.39.31"},
	{"5.9.48.128", "5.9.48.159"},
	{"5.9.98.192", "5.9.98.223"},
	{"5.9.107.160", "5.9.107.191"},
	{"5.9.124.160", "5.9.124.191"},
	{"5.9.147.96", "5.9.147.127"},
	{"5.10.64.0", "5.10.127.255"},
	{"5.10.69.232", "5.10.69.239"},
	{"5.10.77.64", "5.10.77.95"},
	{"5.10.79.64", "5.10.79.127"},
	{"5.10.93.0", "5.10.93.63"},
	{"5.10.94.0", "5.10.94.15"},
	{"5.10.105.32", "5.10.105.63"},
	{"5.35.224.0", "5.35.224.255"},
	{"5.35.228.0", "5.35.228.255"},
	{"5.35.230.0", "5.35.230.255"},
	{"5.35.232.0", "5.35.235.255"},
	{"5.39.8.16", "5.39.8.31"},
	{"5.39.33.192", "5.39.33.207"},
	{"5.39.61.0", "5.39.61.15"},
	{"5.39.64.0", "5.39.79.255"},
	{"5.39.80.0", "5.39.95.255"},
	{"5.39.105.112", "5.39.105.127"},
	{"5.39.109.64", "5.39.109.127"},
	{"5.45.114.0", "5.45.114.255"},
	{"5.45.116.0", "5.45.116.255"},
	{"5.45.118.0", "5.45.118.255"},
	{"5.63.156.0", "5.63.159.255"},
	{"5.79.64.0", "5.79.127.255"},
	{"5.96.0.0", "5.99.255.255"},
	{"5.99.223.0", "5.99.223.255"},
	{"5.100.152.0", "5.100.159.255"},
	{"5.101.114.0", "5.101.114.255"},
	{"5.101.115.0", "5.101.115.255"},
	{"5.101.116.0", "5.101.116.255"},
	{"5.101.117.0", "5.101.117.255"},
	{"5.101.119.0", "5.101.119.255"},
	{"5.101.120.0", "5.101.120.255"},
	{"5.101.121.0", "5.101.121.255"},
	{"5.101.137.0", "5.101.137.7"},
	{"5.101.137.32", "5.101.137.39"},
	{"5.101.137.40", "5.101.137.47"},
	{"5.101.137.48", "5.101.137.63"},
	{"5.101.137.192", "5.101.137.207"},
	{"5.101.138.88", "5.101.138.95"},
	{"5.101.138.136", "5.101.138.143"},
	{"5.101.138.192", "5.101.138.199"},
	{"5.101.139.96", "5.101.139.127"},
	{"5.101.139.136", "5.101.139.143"},
	{"5.101.139.152", "5.101.139.159"},
	{"5.101.139.160", "5.101.139.167"},
	{"5.101.139.208", "5.101.139.215"},
	{"5.101.140.96", "5.101.140.103"},
	{"5.101.140.104", "5.101.140.111"},
	{"5.101.140.112", "5.101.140.127"},
	{"5.101.140.128", "5.101.140.191"},
	{"5.101.140.192", "5.101.140.223"},
	{"5.101.140.224", "5.101.140.239"},
	{"5.101.141.48", "5.101.141.63"},
	{"5.101.142.4", "5.101.142.7"},
	{"5.101.142.224", "5.101.142.231"},
	{"5.101.144.0", "5.101.144.255"},
	{"5.101.145.0", "5.101.145.255"},
	{"5.101.146.0", "5.101.146.3"},
	{"5.101.146.48", "5.101.146.55"},
	{"5.101.146.56", "5.101.146.63"},
	{"5.101.146.112", "5.101.146.119"},
	{"5.101.146.128", "5.101.146.135"},
	{"5.101.146.144", "5.101.146.151"},
	{"5.101.147.64", "5.101.147.79"},
	{"5.101.147.96", "5.101.147.99"},
	{"5.101.147.100", "5.101.147.103"},
	{"5.101.147.136", "5.101.147.143"},
	{"5.101.149.160", "5.101.149.175"},
	{"5.101.152.0", "5.101.152.255"},
	{"5.101.153.0", "5.101.153.255"},
	{"5.101.157.0", "5.101.157.255"},
	{"5.101.168.16", "5.101.168.23"},
	{"5.101.168.24", "5.101.168.31"},
	{"5.101.168.32", "5.101.168.35"},
	{"5.101.168.52", "5.101.168.55"},
	{"5.101.168.56", "5.101.168.63"},
	{"5.101.168.64", "5.101.168.127"},
	{"5.101.168.160", "5.101.168.167"},
	{"5.101.168.192", "5.101.168.207"},
	{"5.104.104.0", "5.104.111.255"},
	{"5.135.5.48", "5.135.5.63"},
	{"5.135.196.56", "5.135.196.63"},
	{"5.135.218.192", "5.135.218.207"},
	{"5.144.163.120", "5.144.165.255"},
	{"5.144.168.0", "5.144.172.255"},
	{"5.149.120.0", "5.149.127.255"},
	{"5.152.192.0", "5.152.223.255"},
	{"5.152.194.0", "5.152.194.31"},
	{"5.152.201.0", "5.152.201.31"},
	{"5.153.0.0", "5.153.63.255"},
	{"5.153.12.240", "5.153.12.247"},
	{"5.153.13.144", "5.153.13.151"},
	{"5.153.13.192", "5.153.13.199"},
	{"5.153.21.192", "5.153.21.223"},
	{"5.153.24.32", "5.153.24.47"},
	{"5.153.25.0", "5.153.25.63"},
	{"5.153.29.64", "5.153.29.127"},
	{"5.153.33.0", "5.153.33.31"},
	{"5.175.8.0", "5.175.8.127"},
	{"5.187.1.0", "5.187.1.255"},
	{"5.187.2.0", "5.187.3.255"},
	{"5.187.4.0", "5.187.5.255"},
	{"5.189.128.0", "5.189.143.255"},
	{"5.189.144.0", "5.189.159.255"},
	{"5.189.160.0", "5.189.175.255"},
	{"5.189.176.0", "5.189.191.255"},
	{"5.196.0.0", "5.196.255.255"},
	{"5.196.118.160", "5.196.118.175"},
	{"5.199.132.0", "5.199.132.255"},
	{"5.249.128.0", "5.249.159.255"},
	{"8.2.120.0", "8.2.121.255"},
	{"8.7.244.0", "8.7.244.255"},
	{"8.8.4.0", "8.8.4.255"},
	{"8.8.8.0", "8.8.8.255"},
	{"8.12.144.0", "8.12.144.255"},
	{"8.18.128.0", "8.18.128.255"},
	{"8.20.110.0", "8.20.110.255"},
	{"8.29.128.0", "8.29.135.255"},
	{"8.29.136.0", "8.29.143.255"},
	{"8.29.152.0", "8.29.159.255"},
	{"8.36.40.0", "8.36.47.255"},
	{"12.163.227.96", "12.163.227.127"},
	{"23.0.0.0", "23.15.255.255"},
	{"23.19.0.0", "23.19.255.255"},
	{"23.20.0.0", "23.23.255.255"},
	{"23.24.0.0", "23.25.255.255"},
	{"23.25.0.0", "23.25.63.255"},
	{"23.29.128.0", "23.29.159.255"},
	{"23.30.0.0", "23.31.255.255"},
	{"23.32.0.0", "23.67.255.255"},
	{"23.72.0.0", "23.79.255.255"},
	{"23.80.0.0", "23.83.255.255"},
	{"23.80.0.0", "23.83.207.255"},
	{"23.88.0.0", "23.89.255.255"},
	{"23.91.0.0", "23.91.31.255"},
	{"23.91.112.0", "23.91.127.255"},
	{"23.91.192.0", "23.91.223.255"},
	{"23.92.16.0", "23.92.31.255"},
	{"23.94.0.0", "23.95.255.255"},
	{"23.104.0.0", "23.111.255.255"},
	{"23.104.0.0", "23.105.191.255"},
	{"23.105.224.0", "23.106.127.255"},
	{"23.106.160.0", "23.111.63.255"},
	{"23.111.192.0", "23.111.255.255"},
	{"23.192.0.0", "23.223.255.255"},
	{"23.228.128.0", "23.228.191.255"},
	{"23.229.128.0", "23.229.255.255"},
	{"23.238.0.0", "23.238.127.255"},
	{"23.238.128.0", "23.238.255.255"},
	{"23.239.0.0", "23.239.31.255"},
	{"23.244.0.0", "23.245.255.255"},
	{"23.246.192.0", "23.246.255.255"},
	{"23.246.230.32", "23.246.230.35"},
	{"23.246.242.0", "23.246.242.3"},
	{"23.246.244.216", "23.246.244.219"},
	{"23.246.247.16", "23.246.247.23"},
	{"23.251.0.0", "23.251.31.255"},
	{"23.252.112.0", "23.252.127.255"},
	{"23.255.128.0", "23.255.255.255"},
	{"24.24.0.0", "24.27.255.255"},
	{"24.28.0.0", "24.29.255.255"},
	{"24.30.128.0", "24.30.191.255"},
	{"24.30.192.0", "24.30.223.255"},
	{"24.31.32.0", "24.31.63.255"},
	{"24.31.128.0", "24.31.255.255"},
	{"24.33.0.0", "24.33.31.255"},
	{"24.33.64.0", "24.33.127.255"},
	{"24.33.192.0", "24.33.223.255"},
	{"24.33.224.0", "24.33.239.255"},
	{"24.39.128.0", "24.39.255.255"},
	{"24.55.0.0", "24.55.31.255"},
	{"24.56.64.0", "24.56.79.255"},
	{"24.56.80.0", "24.56.95.255"},
	{"24.58.0.0", "24.58.255.255"},
	{"24.59.0.0", "24.59.255.255"},
	{"24.73.128.0", "24.73.159.255"},
	{"24.73.160.0", "24.73.175.255"},
	{"24.73.176.0", "24.73.191.255"},
	{"24.73.192.0", "24.73.223.255"},
	{"24.73.240.0", "24.73.255.255"},
	{"24.74.0.0", "24.74.63.255"},
	{"24.74.64.0", "24.74.79.255"},
	{"24.74.96.0", "24.74.127.255"},
	{"24.74.128.0", "24.74.191.255"},
	{"24.74.192.0", "24.74.223.255"},
	{"24.88.0.0", "24.88.127.255"},
	{"24.88.160.0", "24.88.191.255"},
	{"24.88.192.0", "24.88.255.255"},
	{"24.90.0.0", "24.90.127.255"},
	{"24.90.128.0", "24.90.255.255"},
	{"24.92.0.0", "24.92.127.255"},
	{"24.92.160.0", "24.92.191.255"},
	{"24.92.192.0", "24.92.255.255"},
	{"24.97.0.0", "24.97.127.255"},
	{"24.97.128.0", "24.97.255.255"},
	{"24.103.0.0", "24.103.63.255"},
	{"24.103.64.0", "24.103.127.255"},
	{"24.103.128.0", "24.103.255.255"},
	{"24.105.128.0", "24.105.143.255"},
	{"24.105.144.0", "24.105.159.255"},
	{"24.106.144.0", "24.106.159.255"},
	{"24.136.96.0", "24.136.111.255"},
	{"24.136.112.0", "24.136.127.255"},
	{"24.153.128.0", "24.153.191.255"},
	{"24.153.192.0", "24.153.255.255"},
	{"24.162.0.0", "24.162.255.255"},
	{"24.163.0.0", "24.163.127.255"},
	{"24.163.0.0", "24.163.31.255"},
	{"24.163.128.0", "24.163.143.255"},
	{"24.164.0.0", "24.167.255.255"},
	{"24.168.0.0", "24.169.255.255"},
	{"24.170.0.0", "24.170.127.255"},
	{"24.172.128.0", "24.172.191.255"},
	{"24.172.224.0", "24.172.239.255"},
	{"24.173.128.0", "24.173.159.255"},
	{"24.175.128.0", "24.175.191.255"},
	{"24.175.192.0", "24.175.255.255"},
	{"24.193.0.0", "24.193.63.255"},
	{"24.193.64.0", "24.193.95.255"},
	{"24.193.96.0", "24.193.111.255"},
	{"24.193.112.0", "24.193.127.255"},
	{"24.193.128.0", "24.193.255.255"},
	{"24.194.0.0", "24.194.127.255"},
	{"24.194.128.0", "24.194.191.255"},
	{"24.195.0.0", "24.195.255.255"},
	{"24.198.0.0", "24.198.63.255"},
	{"24.198.64.0", "24.198.95.255"},
	{"24.198.128.0", "24.198.255.255"},
	{"24.199.0.0", "24.199.31.255"},
	{"24.199.32.0", "24.199.63.255"},
	{"24.208.0.0", "24.208.63.255"},
	{"24.208.64.0", "24.208.127.255"},
	{"24.208.128.0", "24.208.255.255"},
	{"24.209.0.0", "24.209.127.255"},
	{"24.209.128.0", "24.209.159.255"},
	{"24.209.160.0", "24.209.175.255"},
	{"24.209.160.0", "24.209.191.255"},
	{"24.209.192.0", "24.209.255.255"},
	{"24.210.0.0", "24.210.255.255"},
	{"24.211.32.0", "24.211.63.255"},
	{"24.211.128.0", "24.211.255.255"},
	{"24.213.128.0", "24.213.159.255"},
	{"24.213.160.0", "24.213.191.255"},
	{"24.213.192.0", "24.213.255.255"},
	{"24.227.32.0", "24.227.63.255"},
	{"24.227.64.0", "24.227.95.255"},
	{"24.227.96.0", "24.227.111.255"},
	{"24.227.112.0", "24.227.127.255"},
	{"24.227.128.0", "24.227.255.255"},
	{"24.242.0.0", "24.242.127.255"},
	{"24.242.128.0", "24.242.191.255"},
	{"24.243.0.0", "24.243.255.255"},
	{"27.34.136.0", "27.34.143.255"},
	{"27.121.64.0", "27.121.71.255"},
	{"27.134.240.0", "27.134.240.255"},
	{"27.134.244.0", "27.134.244.255"},
	{"27.134.249.0", "27.134.249.255"},
	{"27.134.252.0", "27.134.252.255"},
	{"27.148.0.0", "27.151.255.255"},
	{"27.152.0.0", "27.159.255.255"},
	{"27.254.38.0", "27.254.38.255"},
	{"27.254.55.0", "27.254.55.255"},
	{"27.254.85.0", "27.254.85.255"},
	{"27.254.96.0", "27.254.96.255"},
	{"27.254.140.0", "27.254.140.255"},
	{"31.3.96.0", "31.3.96.255"},
	{"31.3.97.0", "31.3.97.255"},
	{"31.3.98.0", "31.3.98.255"},
	{"31.3.100.64", "31.3.100.95"},
	{"31.3.102.0", "31.3.102.255"},
	{"31.3.103.0", "31.3.103.255"},
	{"31.3.224.0", "31.3.255.255"},
	{"31.3.232.168", "31.3.232.175"},
	{"31.3.236.176", "31.3.236.183"},
	{"31.11.32.0", "31.11.35.255"},
	{"31.14.133.0", "31.14.133.255"},
	{"31.14.134.0", "31.14.134.255"},
	{"31.14.136.0", "31.14.136.255"},
	{"31.14.137.0", "31.14.137.255"},
	{"31.14.138.0", "31.14.138.255"},
	{"31.14.139.0", "31.14.139.255"},
	{"31.14.140.0", "31.14.140.255"},
	{"31.14.142.0", "31.14.142.255"},
	{"31.31.204.0", "31.31.205.255"},
	{"31.132.3.16", "31.132.3.31"},
	{"31.132.3.128", "31.132.3.255"},
	{"31.132.4.0", "31.132.4.127"},
	{"31.132.4.192", "31.132.4.255"},
	{"31.132.6.80", "31.132.6.95"},
	{"31.132.6.128", "31.132.6.143"},
	{"31.132.6.144", "31.132.6.159"},
	{"31.132.6.224", "31.132.6.255"},
	{"31.132.7.64", "31.132.7.127"},
	{"31.168.0.0", "31.168.15.255"},
	{"31.168.0.0", "31.168.255.255"},
	{"31.177.64.0", "31.177.95.255"},
	{"31.186.250.0", "31.186.251.255"},
	{"31.192.208.0", "31.192.208.255"},
	{"31.192.215.0", "31.192.215.255"},
	{"31.193.0.0", "31.193.0.255"},
	{"31.193.1.0", "31.193.1.255"},
	{"31.193.2.0", "31.193.2.255"},
	{"31.193.3.0", "31.193.3.255"},
	{"31.193.4.0", "31.193.4.255"},
	{"31.193.6.0", "31.193.6.255"},
	{"31.193.13.0", "31.193.13.255"},
	{"31.193.14.0", "31.193.14.255"},
	{"31.193.15.0", "31.193.15.255"},
	{"31.194.0.0", "31.199.255.255"},
	{"31.194.143.0", "31.194.143.255"},
	{"31.210.32.0", "31.210.32.255"},
	{"31.210.33.0", "31.210.33.255"},
	{"31.210.34.0", "31.210.34.255"},
	{"31.210.35.0", "31.210.35.255"},
	{"31.210.36.0", "31.210.36.255"},
	{"31.210.38.0", "31.210.38.255"},
	{"31.210.39.0", "31.210.39.255"},
	{"31.210.40.0", "31.210.40.255"},
	{"31.210.42.0", "31.210.42.255"},
	{"31.210.43.0", "31.210.43.255"},
	{"31.210.44.0", "31.210.44.255"},
	{"31.210.45.0", "31.210.45.255"},
	{"31.210.46.0", "31.210.46.255"},
	{"31.210.48.0", "31.210.48.255"},
	{"31.210.52.0", "31.210.52.255"},
	{"31.210.53.0", "31.210.53.255"},
	{"31.210.54.0", "31.210.54.255"},
	{"31.210.55.0", "31.210.55.255"},
	{"31.210.61.0", "31.210.61.255"},
	{"31.210.63.0", "31.210.63.255"},
	{"31.222.164.0", "31.222.167.255"},
	{"31.222.168.0", "31.222.171.255"},
	{"31.222.184.0", "31.222.191.255"},
	{"36.2.48.0", "36.2.48.255"},
	{"36.2.107.0", "36.2.107.255"},
	{"36.2.153.0", "36.2.153.255"},
	{"36.2.154.0", "36.2.154.255"},
	{"36.2.155.0", "36.2.155.255"},
	{"36.2.249.0", "36.2.249.255"},
	{"36.3.106.0", "36.3.106.255"},
	{"36.3.107.0", "36.3.107.255"},
	{"36.3.108.0", "36.3.108.255"},
	{"36.3.112.0", "36.3.112.255"},
	{"36.3.114.0", "36.3.114.255"},
	{"36.3.121.0", "36.3.121.255"},
	{"36.3.126.0", "36.3.126.255"},
	{"36.3.129.0", "36.3.129.255"},
	{"37.9.57.128", "37.9.57.255"},
	{"37.9.58.0", "37.9.58.127"},
	{"37.9.58.128", "37.9.58.255"},
	{"37.9.60.0", "37.9.60.255"},
	{"37.9.61.48", "37.9.61.55"},
	{"37.9.61.56", "37.9.61.63"},
	{"37.9.61.160", "37.9.61.191"},
	{"37.9.61.192", "37.9.61.255"},
	{"37.9.62.0", "37.9.62.255"},
	{"37.9.62.192", "37.9.62.255"},
	{"37.9.63.0", "37.9.63.255"},
	{"37.9.168.0", "37.9.175.255"},
	{"37.9.224.0", "37.9.228.223"},
	{"37.9.232.160", "37.9.237.63"},
	{"37.12.0.0", "37.12.255.255"},
	{"37.13.0.0", "37.13.255.255"},
	{"37.34.49.0", "37.34.49.255"},
	{"37.34.51.0", "37.34.51.255"},
	{"37.34.53.0", "37.34.53.255"},
	{"37.34.58.0", "37.34.58.255"},
	{"37.34.60.0", "37.34.60.255"},
	{"37.34.63.0", "37.34.63.255"},
	{"37.48.64.0", "37.48.127.255"},
	{"37.58.64.0", "37.58.127.255"},
	{"37.58.68.192", "37.58.68.255"},
	{"37.58.83.96", "37.58.83.127"},
	{"37.58.85.192", "37.58.85.192"},
	{"37.58.87.32", "37.58.87.39"},
	{"37.58.91.224", "37.58.91.255"},
	{"37.58.106.96", "37.58.106.103"},
	{"37.58.127.152", "37.58.127.159"},
	{"37.59.90.160", "37.59.90.175"},
	{"37.59.138.128", "37.59.138.191"},
	{"37.59.145.68", "37.59.145.71"},
	{"37.59.177.96", "37.59.177.103"},
	{"37.59.203.68", "37.59.203.71"},
	{"37.59.253.192", "37.59.253.255"},
	{"37.60.224.0", "37.60.255.255"},
	{"37.60.225.0", "37.60.225.255"},
	{"37.60.227.0", "37.60.227.255"},
	{"37.60.228.0", "37.60.228.255"},
	{"37.60.229.0", "37.60.229.255"},
	{"37.60.231.0", "37.60.231.255"},
	{"37.60.233.0", "37.60.233.255"},
	{"37.60.234.0", "37.60.234.255"},
	{"37.60.235.0", "37.60.235.255"},
	{"37.60.236.0", "37.60.236.255"},
	{"37.60.237.0", "37.60.237.255"},
	{"37.60.238.0", "37.60.238.255"},
	{"37.60.239.0", "37.60.239.255"},
	{"37.60.240.0", "37.60.240.255"},
	{"37.60.241.0", "37.60.241.255"},
	{"37.60.242.0", "37.60.242.255"},
	{"37.60.243.0", "37.60.243.255"},
	{"37.60.244.0", "37.60.244.255"},
	{"37.60.247.0", "37.60.247.255"},
	{"37.60.249.0", "37.60.249.255"},
	{"37.61.192.0", "37.61.223.255"},
	{"37.122.208.0", "37.122.211.255"},
	{"37.140.198.0", "37.140.199.255"},
	{"37.143.12.0", "37.143.13.255"},
	{"37.143.14.0", "37.143.15.255"},
	{"37.148.200.0", "37.148.203.255"},
	{"37.148.204.0", "37.148.207.255"},
	{"37.157.240.0", "37.157.247.255"},
	{"37.157.240.104", "37.157.240.111"},
	{"37.157.242.0", "37.157.243.255"},
	{"37.186.192.0", "37.186.255.255"},
	{"37.187.0.0", "37.187.31.255"},
	{"37.188.116.0", "37.188.117.255"},
	{"37.200.98.0", "37.200.99.255"},
	{"37.200.100.0", "37.200.100.255"},
	{"37.205.128.0", "37.207.255.255"},
	{"37.220.0.0", "37.220.31.255"},
	{"37.220.88.0", "37.220.88.255"},
	{"37.220.89.0", "37.220.89.255"},
	{"37.220.90.0", "37.220.90.255"},
	{"37.220.92.0", "37.220.92.255"},
	{"37.220.94.0", "37.220.94.255"},
	{"37.220.95.0", "37.220.95.255"},
	{"37.230.99.0", "37.230.99.255"},
	{"37.230.102.0", "37.230.102.255"},
	{"38.113.1.0", "38.113.1.255"},
	{"38.126.44.0", "38.126.45.255"},
	{"43.241.52.0", "43.241.55.255"},
	{"43.252.120.0", "43.252.121.255"},
	{"43.254.40.0", "43.254.43.255"},
	{"45.34.0.0", "45.35.255.255"},
	{"45.36.0.0", "45.37.255.255"},
	{"45.40.128.0", "45.40.191.255"},
	{"45.56.64.0", "45.56.127.255"},
	{"45.58.128.0", "45.58.191.255"},
	{"45.63.0.0", "45.63.127.255"},
	{"45.64.0.0", "45.64.3.255"},
	{"45.79.0.0", "45.79.255.255"},
	{"45.118.132.0", "45.118.135.255"},
	{"45.122.236.0", "45.122.239.255"},
	{"46.4.68.64", "46.4.68.95"},
	{"46.4.72.96", "46.4.72.127"},
	{"46.4.72.192", "46.4.72.223"},
	{"46.4.121.160", "46.4.121.191"},
	{"46.16.58.0", "46.16.59.255"},
	{"46.16.60.0", "46.16.61.255"},
	{"46.16.62.0", "46.16.63.255"},
	{"46.16.184.0", "46.16.191.255"},
	{"46.16.186.64", "46.16.186.95"},
	{"46.17.5.0", "46.17.5.31"},
	{"46.17.5.32", "46.17.5.63"},
	{"46.17.6.0", "46.17.6.255"},
	{"46.20.42.208", "46.20.42.215"},
	{"46.23.64.8", "46.23.64.15"},
	{"46.23.64.96", "46.23.64.103"},
	{"46.23.65.160", "46.23.65.191"},
	{"46.23.65.192", "46.23.65.207"},
	{"46.23.66.48", "46.23.66.55"},
	{"46.23.66.56", "46.23.66.63"},
	{"46.23.66.64", "46.23.66.95"},
	{"46.23.66.160", "46.23.66.191"},
	{"46.23.69.32", "46.23.69.47"},
	{"46.23.71.0", "46.23.71.255"},
	{"46.28.105.0", "46.28.105.255"},
	{"46.29.89.0", "46.29.89.255"},
	{"46.29.93.0", "46.29.93.255"},
	{"46.30.208.0", "46.30.215.255"},
	{"46.32.224.0", "46.32.224.255"},
	{"46.32.226.0", "46.32.227.255"},
	{"46.32.228.0", "46.32.229.255"},
	{"46.32.230.0", "46.32.231.255"},
	{"46.32.232.0", "46.32.235.255"},
	{"46.32.236.0", "46.32.239.255"},
	{"46.32.243.0", "46.32.243.255"},
	{"46.32.244.0", "46.32.247.255"},
	{"46.32.249.0", "46.32.249.255"},
	{"46.32.250.0", "46.32.251.255"},
	{"46.32.252.0", "46.32.253.255"},
	{"46.32.254.0", "46.32.255.255"},
	{"46.36.221.0", "46.36.221.255"},
	{"46.36.223.0", "46.36.223.255"},
	{"46.37.0.0", "46.37.31.255"},
	{"46.37.160.0", "46.37.191.255"},
	{"46.37.190.0", "46.37.190.255"},
	{"5.135.0.0", "5.135.255.255"},
	{"37.59.0.0", "37.59.255.255"},
	{"178.32.0.0", "178.33.255.255"},
	{"5.196.0.0", "5.196.255.255"},
	{"192.95.60.56", "192.95.60.59"},
	{"149.202.0.0", "149.202.255.255"},
	{"87.98.224.32", "87.98.224.63"},
	{"51.254.0.0", "51.255.255.255"},
	{"188.165.0.0", "188.165.255.255"},
	{"149.56.235.0", "149.56.235.255"},
	{"192.95.4.88", "192.95.4.91"},
	{"213.186.50.96", "213.186.50.111"},
	{"46.105.0.0", "46.105.255.255"},
	{"87.98.128.0", "87.98.191.255"},
	{"158.69.152.44", "158.69.152.47"},
	{"167.114.195.224", "167.114.195.255"},
	{"198.50.141.76", "198.50.141.79"},
	{"198.100.152.0", "198.100.152.255"},
	{"151.80.0.0", "151.80.255.255"},
	{"158.69.129.36", "158.69.129.39"},
	{"176.31.0.0", "176.31.255.255"},
	{"167.114.186.0", "167.114.186.255"},
	{"147.135.128.0", "147.135.255.255"},
	{"158.69.98.176", "158.69.98.191"},
	{"213.186.63.96", "213.186.63.111"},
	{"158.69.131.48", "158.69.131.55"},
	{"213.186.35.0", "213.186.35.255"},
	{"92.222.0.0", "92.222.255.255"},
	{"158.69.151.240", "158.69.151.255"},
	{"79.137.0.0", "79.137.127.255"},
	{"192.95.15.204", "192.95.15.207"},
	{"198.50.140.200", "198.50.140.207"},
	{"192.95.22.0", "192.95.22.255"},
	{"5.39.0.0", "5.39.127.255"},
	{"213.251.128.0", "213.251.191.255"},
	{"198.50.178.208", "198.50.178.215"},
	{"213.186.62.0", "213.186.62.255"},
	{"158.69.141.0", "158.69.141.255"},
	{"192.95.16.0", "192.95.16.255"},
	{"91.121.0.0", "91.121.255.255"},
	{"149.56.197.128", "149.56.197.255"},
	{"192.99.60.160", "192.99.60.191"},
	{"158.69.149.24", "158.69.149.31"},
	{"192.99.60.32", "192.99.60.47"},
	{"207.45.195.24", "207.45.195.31"},
	{"213.186.61.0", "213.186.61.255"},
	{"213.186.54.192", "213.186.54.207"},
	{"198.50.244.224", "198.50.244.231"},
	{"66.70.249.0", "66.70.249.255"},
	{"198.245.56.0", "198.245.57.255"},
	{"198.50.177.216", "198.50.177.223"},
	{"158.69.142.64", "158.69.142.79"},
	{"213.186.50.192", "213.186.50.207"},
	{"213.186.56.0", "213.186.56.255"},
	{"149.56.233.128", "149.56.233.255"},
	{"213.186.49.32", "213.186.49.47"},
	{"213.186.54.96", "213.186.54.111"},
	{"213.186.58.0", "213.186.58.255"},
	{"213.186.40.0", "213.186.41.255"},
	{"213.186.53.224", "213.186.53.239"},
	{"213.186.36.0", "213.186.36.255"},
	{"213.186.54.16", "213.186.54.31"},
	{"213.186.44.0", "213.186.47.255"},
	{"198.50.233.80", "198.50.233.83"},
	{"198.50.238.0", "198.50.238.255"},
	{"198.50.152.0", "198.50.155.255"},
	{"213.186.37.0", "213.186.37.255"},
	{"217.182.0.0", "217.182.255.255"},
	{"213.186.38.0", "213.186.38.255"},
	{"213.186.53.192", "213.186.53.223"},
	{"66.70.254.0", "66.70.254.255"},
	{"213.186.39.0", "213.186.39.255"},
	{"213.186.33.0", "213.186.33.255"},
	{"213.186.54.128", "213.186.54.143"},
	{"213.186.48.0", "213.186.48.63"},
	{"213.186.57.0", "213.186.57.255"},
	{"192.95.56.0", "192.95.56.255"},
	{"192.95.17.0", "192.95.17.255"},
	{"192.95.38.0", "192.95.39.255"},
	{"192.99.119.120", "192.99.119.123"},
	{"167.114.219.0", "167.114.219.255"},
	{"192.99.182.0", "192.99.182.255"},
	{"149.56.8.64", "149.56.8.127"},
	{"94.23.0.0", "94.23.255.255"},
	{"198.50.230.240", "198.50.230.247"},
	{"198.50.253.160", "198.50.253.175"},
	{"167.114.70.0", "167.114.70.255"},
	{"213.186.59.0", "213.186.59.255"},
	{"198.50.224.168", "198.50.224.171"},
	{"192.99.41.0", "192.99.41.255"},
	{"198.27.126.0", "198.27.127.255"},
	{"137.74.0.0", "137.74.255.255"},
	{"192.99.165.0", "192.99.165.255"},
	{"54.36.0.0", "54.39.255.255"},
	{"142.44.177.0", "142.44.177.255"},
	{"198.50.252.92", "198.50.252.95"},
	{"142.4.200.0", "142.4.201.255"},
	{"38.104.141.152", "38.104.141.159"},
	{"198.50.219.148", "198.50.219.151"},
	{"198.50.211.112", "198.50.211.115"},
	{"198.50.249.208", "198.50.249.215"},
	{"198.50.184.100", "198.50.184.103"},
	{"192.99.176.80", "192.99.176.95"},
	{"158.69.128.112", "158.69.128.119"},
	{"144.217.239.0", "144.217.239.255"},
	{"192.95.18.0", "192.95.18.255"},
	{"192.99.170.0", "192.99.170.255"},
	{"192.99.127.120", "192.99.127.127"},
	{"109.190.0.0", "109.190.255.255"},
	{"158.69.2.0", "158.69.3.255"},
	{"192.95.23.0", "192.95.23.255"},
	{"213.186.60.0", "213.186.60.255"},
	{"213.186.34.0", "213.186.34.255"},
	{"158.69.134.192", "158.69.134.223"},
	{"144.217.223.0", "144.217.223.255"},
	{"193.70.0.0", "193.70.127.255"},
	{"158.69.101.0", "158.69.101.255"},
	{"144.217.251.0", "144.217.251.255"},
	{"213.186.42.0", "213.186.42.255"},
	{"192.99.109.48", "192.99.109.55"},
	{"164.132.0.0", "164.132.255.255"},
	{"145.239.0.0", "145.239.255.255"},
	{"198.100.156.0", "198.100.157.255"},
	{"192.99.81.128", "192.99.81.255"},
	{"158.69.152.0", "158.69.152.15"},
	{"66.70.199.0", "66.70.199.255"},
	{"198.50.239.0", "198.50.239.255"},
	{"66.70.149.0", "66.70.149.255"},
	{"151.127.0.0", "151.127.255.255"},
	{"213.186.48.64", "213.186.48.79"},
	{"213.186.32.0", "213.186.32.255"},
	{"198.50.172.172", "198.50.172.175"},
	{"158.69.115.0", "158.69.115.255"},
	{"213.186.53.128", "213.186.53.143"},
	{"192.99.27.0", "192.99.27.255"},
	{"66.70.193.0", "66.70.193.255"},
	{"66.70.171.0", "66.70.171.255"},
	{"66.70.166.0", "66.70.166.255"},
	{"66.70.163.0", "66.70.163.255"},
	{"66.70.128.0", "66.70.128.255"},
	{"213.32.0.0", "213.32.127.255"},
	{"37.187.0.0", "37.187.255.255"},
	{"91.134.0.0", "91.134.255.255"},
	{"66.70.147.0", "66.70.147.255"},
	{"66.70.159.0", "66.70.159.255"},
	{"87.98.128.0", "87.98.255.255"},
	{"167.114.170.0", "167.114.170.255"},
	{"167.114.171.0", "167.114.171.255"},
	{"167.114.11.0", "167.114.11.255"},
	{"167.114.99.0", "167.114.99.255"},
	{"144.217.47.0", "144.217.47.255"},
	{"144.217.51.0", "144.217.51.255"},
	{"144.217.41.0", "144.217.41.255"},
	{"144.217.55.0", "144.217.55.255"},
	{"178.33.5.24", "178.33.5.27"},
	{"37.59.167.8", "37.59.167.11"},
	{"94.23.99.168", "94.23.99.175"},
	{"37.59.145.192", "37.59.145.255"},
	{"178.33.3.232", "178.33.3.235"},
	{"178.32.163.48", "178.32.163.51"},
	{"5.39.18.176", "5.39.18.179"},
	{"46.105.169.144", "46.105.169.147"},
	{"37.59.242.248", "37.59.242.255"},
	{"178.33.146.160", "178.33.146.175"},
	{"178.33.145.52", "178.33.145.55"},
	{"178.32.68.80", "178.32.68.95"},
	{"176.31.28.48", "176.31.28.63"},
	{"51.255.232.128", "51.255.232.255"},
	{"178.32.21.128", "178.32.21.191"},
	{"178.32.251.64", "178.32.251.79"},
	{"176.31.28.176", "176.31.28.179"},
	{"178.33.129.60", "178.33.129.63"},
	{"178.32.169.28", "178.32.169.31"},
	{"178.32.5.120", "178.32.5.127"},
	{"176.31.209.0", "176.31.209.31"},
	{"176.31.43.204", "176.31.43.207"},
	{"5.39.32.160", "5.39.32.163"},
	{"94.23.116.152", "94.23.116.159"},
	{"178.33.192.32", "178.33.192.63"},
	{"94.23.99.32", "94.23.99.35"},
	{"92.222.231.160", "92.222.231.191"},
	{"94.23.178.96", "94.23.178.103"},
	{"176.31.14.96", "176.31.14.99"},
	{"178.32.70.128", "178.32.70.159"},
	{"178.33.68.80", "178.33.68.83"},
	{"178.32.72.112", "178.32.72.115"},
	{"178.33.138.56", "178.33.138.59"},
	{"94.23.114.224", "94.23.114.239"},
	{"213.32.11.0", "213.32.11.255"},
	{"217.182.4.0", "217.182.4.127"},
	{"178.33.86.180", "178.33.86.183"},
	{"178.33.133.60", "178.33.133.63"},
	{"176.31.91.16", "176.31.91.19"},
	{"176.31.136.184", "176.31.136.187"},
	{"176.31.128.16", "176.31.128.31"},
	{"5.135.82.16", "5.135.82.31"},
	{"178.32.244.176", "178.32.244.191"},
	{"37.59.156.136", "37.59.156.143"},
	{"51.254.153.224", "51.254.153.255"},
	{"151.80.125.64", "151.80.125.127"},
	{"37.59.207.20", "37.59.207.23"},
	{"213.186.53.64", "213.186.53.79"},
	{"91.134.189.0", "91.134.189.255"},
	{"147.135.203.128", "147.135.203.255"},
	{"176.31.206.48", "176.31.206.51"},
	{"164.132.137.128", "164.132.137.255"},
	{"137.74.188.192", "137.74.188.223"},
	{"149.202.250.0", "149.202.250.127"},
	{"178.32.249.32", "178.32.249.47"},
	{"51.254.94.128", "51.254.94.255"},
	{"37.59.204.176", "37.59.204.179"},
	{"94.23.108.96", "94.23.108.127"},
	{"51.254.16.128", "51.254.16.255"},
	{"5.135.7.116", "5.135.7.119"},
	{"149.202.124.48", "149.202.124.63"},
	{"51.254.86.192", "51.254.86.223"},
	{"37.59.80.20", "37.59.80.23"},
	{"79.137.17.128", "79.137.17.255"},
	{"149.202.31.96", "149.202.31.127"},
	{"178.32.177.188", "178.32.177.191"},
	{"176.31.62.76", "176.31.62.79"},
	{"193.70.71.0", "193.70.71.255"},
	{"37.59.253.108", "37.59.253.111"},
	{"188.165.75.92", "188.165.75.95"},
	{"37.59.177.0", "37.59.177.3"},
	{"91.121.229.72", "91.121.229.75"},
	{"149.202.152.128", "149.202.152.255"},
	{"91.121.230.192", "91.121.230.207"},
	{"94.23.98.96", "94.23.98.111"},
	{"188.165.85.104", "188.165.85.107"},
	{"178.33.130.208", "178.33.130.215"},
	{"5.135.41.188", "5.135.41.191"},
	{"178.33.222.248", "178.33.222.251"},
	{"94.23.109.160", "94.23.109.167"},
	{"188.165.62.96", "188.165.62.127"},
	{"94.23.152.0", "94.23.159.255"},
	{"91.121.255.16", "91.121.255.31"},
	{"92.222.233.0", "92.222.233.63"},
	{"176.31.92.100", "176.31.92.103"},
	{"37.59.215.192", "37.59.215.199"},
	{"37.187.208.0", "37.187.208.255"},
	{"188.165.169.96", "188.165.169.103"},
	{"164.132.177.128", "164.132.177.255"},
	{"178.32.48.0", "178.32.55.255"},
	{"178.32.56.0", "178.32.63.255"},
	{"87.98.254.0", "87.98.254.255"},
	{"87.98.250.0", "87.98.250.255"},
	{"92.222.176.0", "92.222.176.255"},
	{"5.135.87.64", "5.135.87.127"},
	{"5.135.85.240", "5.135.85.255"},
	{"5.135.247.224", "5.135.247.239"},
	{"5.135.173.128", "5.135.173.255"},
	{"5.135.18.192", "5.135.18.223"},
	{"91.134.27.128", "91.134.27.255"},
	{"92.222.51.0", "92.222.51.63"},
	{"178.32.196.192", "178.32.196.255"},
	{"51.254.177.0", "51.254.177.127"},
	{"91.121.229.80", "91.121.229.95"},
	{"92.222.105.128", "92.222.105.143"},
	{"5.39.2.252", "5.39.2.255"},
	{"164.132.90.0", "164.132.90.255"},
	{"164.132.239.128", "164.132.239.255"},
	{"178.33.186.64", "178.33.186.127"},
	{"178.33.101.0", "178.33.101.127"},
	{"37.59.196.140", "37.59.196.143"},
	{"145.239.104.0", "145.239.104.127"},
	{"164.132.208.224", "164.132.208.255"},
	{"37.59.67.56", "37.59.67.59"},
	{"37.59.73.176", "37.59.73.179"},
	{"46.105.27.0", "46.105.27.255"},
	{"46.105.246.244", "46.105.246.247"},
	{"91.121.246.216", "91.121.246.223"},
	{"147.135.177.0", "147.135.177.127"},
	{"147.135.186.0", "147.135.186.127"},
	{"37.59.189.128", "37.59.189.131"},
	{"92.222.50.128", "92.222.50.191"},
	{"92.222.96.128", "92.222.96.255"},
	{"176.31.47.160", "176.31.47.191"},
	{"5.135.20.224", "5.135.20.255"},
	{"5.135.60.44", "5.135.60.47"},
	{"91.134.177.192", "91.134.177.255"},
	{"176.31.45.192", "176.31.45.223"},
	{"5.135.99.132", "5.135.99.135"},
	{"178.33.6.56", "178.33.6.59"},
	{"188.165.11.128", "188.165.11.255"},
	{"5.39.1.0", "5.39.1.3"},
	{"46.105.187.0", "46.105.187.63"},
	{"51.254.31.128", "51.254.31.255"},
	{"176.31.206.64", "176.31.206.79"},
	{"46.105.133.84", "46.105.133.87"},
	{"46.105.94.192", "46.105.94.255"},
	{"46.105.189.176", "46.105.189.179"},
	{"51.255.142.128", "51.255.142.255"},
	{"87.98.255.0", "87.98.255.255"},
	{"176.31.41.128", "176.31.41.159"},
	{"87.98.248.0", "87.98.249.255"},
	{"37.59.252.188", "37.59.252.191"},
	{"37.59.166.56", "37.59.166.63"},
	{"37.59.198.144", "37.59.198.147"},
	{"176.31.3.192", "176.31.3.199"},
	{"149.202.138.128", "149.202.138.255"},
	{"51.255.132.64", "51.255.132.95"},
	{"46.105.169.240", "46.105.169.243"},
	{"178.33.174.224", "178.33.174.231"},
	{"94.23.120.0", "94.23.121.255"},
	{"5.39.6.64", "5.39.6.127"},
	{"37.187.203.0", "37.187.203.255"},
	{"145.239.118.128", "145.239.118.255"},
	{"91.134.145.0", "91.134.145.255"},
	{"188.165.152.188", "188.165.152.191"},
	{"91.121.227.68", "91.121.227.71"},
	{"46.105.233.28", "46.105.233.31"},
	{"51.254.238.128", "51.254.238.255"},
	{"46.105.90.128", "46.105.90.191"},
	{"5.39.10.240", "5.39.10.247"},
	{"178.32.252.80", "178.32.252.95"},
	{"37.59.132.208", "37.59.132.223"},
	{"151.80.126.128", "151.80.126.255"},
	{"5.39.114.128", "5.39.114.159"},
	{"91.121.237.160", "91.121.237.175"},
	{"213.32.113.0", "213.32.113.255"},
	{"164.132.12.128", "164.132.12.255"},
	{"178.33.216.164", "178.33.216.167"},
	{"178.33.209.240", "178.33.209.255"},
	{"178.33.222.0", "178.33.222.31"},
	{"178.33.210.156", "178.33.210.159"},
	{"91.121.243.0", "91.121.243.15"},
	{"164.132.4.128", "164.132.4.255"},
	{"5.39.53.216", "5.39.53.219"},
	{"5.39.41.64", "5.39.41.95"},
	{"37.59.93.224", "37.59.93.239"},
	{"37.59.184.216", "37.59.184.219"},
	{"5.39.20.248", "5.39.20.251"},
	{"5.39.11.160", "5.39.11.167"},
	{"91.134.231.0", "91.134.231.255"},
	{"178.33.208.160", "178.33.208.191"},
	{"46.105.166.108", "46.105.166.111"},
	{"178.33.159.128", "178.33.159.131"},
	{"178.32.87.76", "178.32.87.79"},
	{"178.32.158.48", "178.32.158.51"},
	{"178.32.225.148", "178.32.225.151"},
	{"5.39.125.180", "5.39.125.183"},
	{"176.31.61.192", "176.31.61.223"},
	{"5.196.175.64", "5.196.175.127"},
	{"176.31.14.32", "176.31.14.47"},
	{"5.196.171.0", "5.196.171.127"},
	{"188.165.156.240", "188.165.156.255"},
	{"46.105.144.96", "46.105.144.127"},
	{"94.23.96.76", "94.23.96.79"},
	{"37.59.232.0", "37.59.232.3"},
	{"137.74.80.128", "137.74.80.255"},
	{"51.254.152.128", "51.254.152.255"},
	{"188.165.73.128", "188.165.73.191"},
	{"147.135.184.128", "147.135.184.255"},
	{"46.105.254.4", "46.105.254.7"},
	{"46.105.245.92", "46.105.245.95"},
	{"91.134.201.0", "91.134.201.255"},
	{"176.31.48.228", "176.31.48.231"},
	{"5.135.124.240", "5.135.124.243"},
	{"188.72.81.0", "188.72.81.255"}
}

local countries = {}
local blackList = {}
local forceKickIPList = {}
local countryDeny = {}
local ovhDeny = {}
local hetznerDeny = {}
local digitalDeny = {}
local arubaDeny = {}
local playerByIP = {}

function str2Dig(ipstr)
    local ret = 0;
    for d in string.gmatch(ipstr, "%d+") do
        ret = ret * 256 + d;
    end
    return ret;
end

function checkInRange(ip, min, max)
    ip = str2Dig(ip);
    min = str2Dig(min);
    max = str2Dig(max);
    return min < ip and ip < max;
end

function checkIP(ip)
    for i, v in ipairs(ipList) do
        if(checkInRange(ip, v[1], v[2]))then
            return false;
        end
    end
    return true;
end

local blacklistedIPs = {
    ["0.0.0.0"] = true,
}

local blacklistSERIALS = {
	["ABC"] = true,
}

addEventHandler("onPlayerConnect", root, function(playerNick, playerIP, playerUsername, playerSerial, playerVersionNumbe)
	--print(blacklistedIPs[playerIP])
	if blacklistedIPs[playerIP] then 
		cancelEvent(true, "Az IP címed VPN hálózatra utal.")
		logAnticheat("Login deny (blacklist) | Player: ".. playerNick .. " | IP:"..playerIP .. " | Serial: ".. playerSerial .. " | Version: ".. playerVersionNumbe)
	end
	if not checkIP(playerIP) then
		cancelEvent(true, "Az IP címed ki van tíltva.")
		logAnticheat("Login deny (ip range) | Player: ".. playerNick .. " | IP:"..playerIP .. " | Serial: ".. playerSerial .. " | Version: ".. playerVersionNumbe)
	end
	if blacklistSERIALS[playerSerial] then 
		cancelEvent(true, "Ki vagy tiltva.")
		logAnticheat("Login deny (serial) | Player: ".. playerNick .. " | IP:"..playerIP .. " | Serial: ".. playerSerial .. " | Version: ".. playerVersionNumbe)
	end
end)

function loadIPBlacklistTable()
    local start = getTickCount()
    local ipcount = 0

    fetchRemote ( "http://myip.ms/files/blacklist/csf/latest_blacklist.txt", function(data, ec)
        if ec == 0 then
            local ips = split(data, "\n")

            ipcount = 0
            for i, v in ipairs(ips) do
                --print(v)
                if string.find(v, "%x.%x.%x.%x") and not blacklistedIPs[v] then
                    blacklistedIPs[v] = true
                    ipcount = ipcount + 1
                end
            end

            outputDebugString(ipcount.."db blokkolt ip cím betöltve! "..(getTickCount()-start).."ms",0,124,197,118)
        else
            outputDebugString("Hiba az IP betöltések során!",0,210,49,49)
        end
    end, "", false)

    fetchRemote ( "https://raw.githubusercontent.com/ejrv/VPNs/master/vpn-ipv4.txt", function(data, ec)
        if ec == 0 then
            local ips = split(data, "\n")

            ipcount = 0
            for i, v in ipairs(ips) do
                if string.find(v, "%x.%x.%x.%x") and not blacklistedIPs[v] then
                    blacklistedIPs[v] = true
                    ipcount = ipcount + 1
                end
            end

            outputDebugString(ipcount.."db blokkolt ip cím betöltve! "..(getTickCount()-start).."ms",0,124,197,118)
        else
            outputDebugString("Hiba az IP betöltések során!",0,210,49,49)
        end
    end, "", false)
end
addEventHandler("onResourceStart", resourceRoot, loadIPBlacklistTable)



-- MTA Anticheat
addEventHandler("onPlayerACInfo", root, function(detectedACList)
	for _, acCode in ipairs(detectedACList) do
		local name = tostring(getPlayerName(source))
		if acCode == 14 then
			banPlayer(source, false, false, true, root, "Ez a szerver nem támogatja a virtuális gépek használatát (VMWare stb)")
			logAnticheat(name.." kirúgva: Virtual Machine")
			return
		elseif acCode == 12 then
			kickPlayer(source, "Hibás d3d9.dll fájl!")
			logAnticheat(name.." kirúgva: d3d9.dll")
			return
		elseif acCode == 20 then
			kickPlayer(source, "Hibás gta3.img fájl (ezen a szerveren nem engedélyezettek a custom modok)!")
			logAnticheat(name.." kirúgva: gta3.img")
			return
		end
	end
end)

local verifiedSerials = {}

function loadVerifiedSerials()
	local connection = exports.oMysql:getDBConnection()

	query = dbQuery(connection, 'SELECT * FROM adminserials')
    result = dbPoll(query, 200)

	if result then
		verifiedSerials = {}

		for k, v in ipairs(result) do 
			table.insert(verifiedSerials, v["serial"])
		end

		print(#result .. "db adminisztrátor serial betöltve.")
	end
end
loadVerifiedSerials()


addCommandHandler("reloadverifiedserials", function(player)
	if getElementData(player, "aclLogin") then 
		loadVerifiedSerials()
	end
end)

local lekertSerialok = {}
function checkPlayerVerifiedAdminStatus(player)
	if isElement( player ) then
		if not lekertSerialok[player] then
			lekertSerialok[player] = getPlayerSerial(player)
		end

		local serial = lekertSerialok[player]


		if table.contains(verifiedSerials, serial) then 
			return true 
		else
			local name = getPlayerName(player) or ""
			logAnticheat(name.." nem jogosult adminisztrátor műveletek használatára!")
			kickPlayer(player, "Nem vagy jogosult adminisztrátor műveletek használatára!")
			return false 
		end
	end
end

addEvent("anticheat > checkAdminVerifiedStatus", true)
addEventHandler("anticheat > checkAdminVerifiedStatus", resourceRoot, function()
	if not checkPlayerVerifiedAdminStatus(client) then 
		if isElement(client) then 
			setElementData(client, "user:admin", 0) 
		end 
	end
end)

function table.contains(table, element)
	for _, value in pairs(table) do
	  if value == element then
		return true
	  end
	end
	return false
end